<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>User Guide Â· IndividualDisplacements.jl</title><meta name="title" content="User Guide Â· IndividualDisplacements.jl"/><meta property="og:title" content="User Guide Â· IndividualDisplacements.jl"/><meta property="twitter:title" content="User Guide Â· IndividualDisplacements.jl"/><meta name="description" content="Documentation for IndividualDisplacements.jl."/><meta property="og:description" content="Documentation for IndividualDisplacements.jl."/><meta property="twitter:description" content="Documentation for IndividualDisplacements.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">IndividualDisplacements.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>User Guide</a><ul class="internal"><li><a class="tocitem" href="#User-Guide"><span>User Guide</span></a></li><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Data-Structures"><span>Data Structures</span></a></li><li><a class="tocitem" href="#Main-Functions"><span>Main Functions</span></a></li></ul></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../API/">Tool Box</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>User Guide</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>User Guide</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaClimate/IndividualDisplacements.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ï‚›</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaClimate/IndividualDisplacements.jl/blob/master/docs/src/workflow.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ï„</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="User-Guide"><a class="docs-heading-anchor" href="#User-Guide">User Guide</a><a id="User-Guide-1"></a><a class="docs-heading-anchor-permalink" href="#User-Guide" title="Permalink"></a></h2><p>As shown in the <a href="../examples/#Examples">Examples</a> section, the typical worflow is:</p><ol><li>set up a <code>FlowFields</code> data structure (<code>F</code>)</li><li>set up <code>Individuals</code> (<code>I</code>) with initial position <code>ğŸ“Œ</code> and <code>F</code></li><li>displace <code>I</code> by	<code>solve!(I,T)</code> following <code>I.F</code> over <code>T</code> </li><li>post-process by <code>I.ğŸ”§</code> and record information in <code>I.ğŸ”´</code></li><li>go back to <code>step 2</code> and continue if needed</li></ol><p>The data structures for steps <code>1</code> and <code>2</code> are documented below. Steps <code>3</code> and <code>4</code> normally take place as part of <code>solve!</code> (i.e. <code>âˆ«!</code>) which post-processes results, using ğŸ”§, records them in ğŸ”´, and finally updates the positions of individuals in ğŸ“Œ. Since ğŸ”´ is a <a href="https://juliadata.github.io/DataFrames.jl/latest/">DataFrame</a>, it is easily manipulated, plotted, or saved in step <code>4</code> or after the fact.</p><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>A central goal of this package is to support scientific analysis of model simulations and observations of materials and particles within the Climate System. The package scope thus includes, for example, drifting plastics in the Ocean or chemical compounds in the Atmosphere. </p><p>As a starting point, the package supports all types of gridded model output (on Arakawa C-grids) from the <a href="https://mitgcm.readthedocs.io/en/latest/?badge=latest">MIT General Circulation Model</a> via the <a href="https://github.com/JuliaClimate/MeshArrays.jl">MeshArrays.jl</a> package (<a href="https://juliaclimate.github.io/MeshArrays.jl/dev/">docs found here</a>). </p><p>By convention, <code>IndividualDisplacements.jl</code> expects input flow fields to be provided in a uniform fashion (see <a href="#IndividualDisplacements.FlowFields"><code>FlowFields</code></a>) summarized below: </p><ol><li>normalized to grid index units (i.e. in 1/s rather than m/s units)</li><li>positive towards increasing indices</li><li>using the Arakawa C-grid, with <code>u</code> (resp <code>v</code>) staggered by <code>-0.5</code> point in direction <code>1</code> (resp <code>2</code>) from grid cell centers. </li></ol><p>The <a href="../examples/#Examples">Examples</a> section documents various, simple methods to prepare and ingest such flow fields (time varying or not; in 2D or 3D) and derive individual displacements / trajectories from them. They cover simple grids often used in process studies, Global Ocean simulations normally done on more complex grids, plotting tools, and data formats. </p><p>For an overview of the examples, please refer to the <strong>example guide</strong>. The rest of this section is focused on the package&#39;s <strong>data structures</strong> and <strong>core functions</strong>.</p><h2 id="Data-Structures"><a class="docs-heading-anchor" href="#Data-Structures">Data Structures</a><a id="Data-Structures-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Structures" title="Permalink"></a></h2><p>The <code>Individuals</code> struct contains a <code>FlowFields</code> struct (incl. e.g. arrays), initial positions for the individuals, and the other elements (e.g. functions) involved in <code>âˆ«!(I,T)</code> as documented hereafter.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IndividualDisplacements.FlowFields" href="#IndividualDisplacements.FlowFields"><code>IndividualDisplacements.FlowFields</code></a> â€” <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">abstract type FlowFields</code></pre><p>Data structure that provide access to flow fields (gridded as arrays) which will be  used to interpolate velocities to individual locations later on (once embedded in an <code>Individuals</code> struct). </p><p>Following the C-grid convention also used in <code>MITgcm</code> (https://mitgcm.readthedocs.io)  flow fields are expected to be staggered as follows: grid cell i,j has its center located at i-1/2,j-1/2 while the corresponding <code>u[i,j]</code> (resp. `v[i,j]) is located at i-1,j-1/2 (resp. i-1/2,j-1). </p><p>Also by convention, velocity fields are expected to have been normalized to grid units (e.g. 1/s rather than m/s) before sending them to one of the supported <code>FlowFields</code> constructors (using either <code>Array</code> or <code>MeshArray</code>):</p><pre><code class="nohighlight hljs">uvArrays(u0,u1,v0,v1,T)
uvwArrays(u0,u1,v0,v1,w0,w1,T)
uvMeshArrays(u0,u1,v0,v1,T,update_location!)
uvwMeshArrays(u0,u1,v0,v1,w0,w1,T,update_location!)</code></pre><p>Using the <code>FlowFields</code> constructor which gets selected by the type of <code>u0</code> etc. For example :</p><pre><code class="nohighlight hljs">F=FlowFields(u,u,v,v,0*w,1*w,[0.0,10.0])
F=FlowFields(u,u,v,v,[0.0,10.0],func)</code></pre><p>as shown in the online documentation examples.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaClimate/IndividualDisplacements.jl/blob/72bc66a84d0c1c3600db57763244e83aac9d432a/src/API.jl#L4-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IndividualDisplacements.FlowFields-Tuple{}" href="#IndividualDisplacements.FlowFields-Tuple{}"><code>IndividualDisplacements.FlowFields</code></a> â€” <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FlowFields(; u::Union{Array,Tuple}=[], v::Union{Array,Tuple}=[], w::Union{Array,Tuple}=[], 
period::Union{Array,Tuple}=[], gridtype::Symbol=:centered)</code></pre><p>Construct FlowFields data structure based on keywords.</p><pre><code class="nohighlight hljs">uC, vC, _ = SimpleFlowFields(16)
F=FlowFields(u=uC,v=vC,period=(0,10.))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaClimate/IndividualDisplacements.jl/blob/72bc66a84d0c1c3600db57763244e83aac9d432a/src/API.jl#L66-L76">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IndividualDisplacements.Individuals" href="#IndividualDisplacements.Individuals"><code>IndividualDisplacements.Individuals</code></a> â€” <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct Individuals{T,N}</code></pre><ul><li>Data:           ğŸ“Œ (position),   ğŸ”´(record), ğŸ†” (ID), P (<code>FlowFields</code>)</li><li>Functions:      ğŸš„ (velocity),   âˆ« (integration), ğŸ”§(postprocessing)</li><li>NamedTuples:    D (diagnostics),      M (metadata)</li></ul><p>The velocity function ğŸš„ typically computes velocity at individual positions (ğŸ“Œ to start) within the  specified space-time domain by interpolating gridded variables (provided via P). Individual trajectories  are computed by integrating (âˆ«) interpolated velocities through time. Normally, integration is done by  calling âˆ«! which updates ğŸ“Œ at the end and records results in ğŸ”´ via ğŸ”§. Ancillary data, for use in  ğŸ”§ for example, can be provided in D and metadata stored in M.</p><p>Unicode cheatsheet:</p><ul><li>ğŸ“Œ=<code>\:pushpin:&lt;tab&gt;</code>,          ğŸ”´=<code>\:red_circle:&lt;tab&gt;</code>, ğŸ†”=<code>\:id:&lt;tab&gt;</code></li><li>ğŸš„=<code>\:bullettrain_side:&lt;tab&gt;</code>, âˆ«=<code>\int&lt;tab&gt;</code>,          ğŸ”§=<code>\:wrench:&lt;tab&gt;</code></li><li>P=<code>\itP&lt;tab&gt;</code>,                 D=<code>\itD&lt;tab&gt;</code>,           M=<code>\itM&lt;tab&gt;</code></li></ul><p>Simple constructors that use <code>FlowFields</code> to choose adequate defaults:</p><ul><li>Individuals(F::uvArrays,x,y)</li><li>Individuals(F::uvwArrays,x,y,z)</li><li>Individuals(F::uvMeshArrays,x,y,fid)</li><li>Individuals(F::uvwMeshArrays,x,y,z,fid)</li></ul><p>Further customization is achievable via keyword constructors:</p><pre><code class="nohighlight hljs">df=DataFrame( ID=[], x=[], y=[], z=[], t = [])
I=Individuals{Float64,2}(ğŸ“Œ=zeros(3,10),ğŸ†”=1:10,ğŸ”´=deepcopy(df))
I=Individuals(ğŸ“Œ=zeros(3,2),ğŸ†”=collect(1:2),ğŸ”´=deepcopy(df))</code></pre><p>Or via the plain text (or no-unicode) constructors:</p><pre><code class="nohighlight hljs">df=DataFrame( ID=[], x=[], y=[], z=[], t = [])
I=(position=zeros(3,2),ID=1:2,record=deepcopy(df))
I=Individuals(I)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaClimate/IndividualDisplacements.jl/blob/72bc66a84d0c1c3600db57763244e83aac9d432a/src/API.jl#L198-L239">source</a></section></article><h2 id="Main-Functions"><a class="docs-heading-anchor" href="#Main-Functions">Main Functions</a><a id="Main-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Main-Functions" title="Permalink"></a></h2><p><code>âˆ«!(I,T)</code> displaces individuals I continuously over time period T according to velocity function ğŸš„, temporal integration method âˆ«, and post-processor ğŸ”§ (all embedded within I).</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="IndividualDisplacements.âˆ«!" href="#IndividualDisplacements.âˆ«!"><code>IndividualDisplacements.âˆ«!</code></a> â€” <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">âˆ«!(I::Individuals,T::Tuple)</code></pre><p>Displace simulated individuals continuously through space over time period T starting from position ğŸ“Œ. </p><ul><li>This is typically achieved by computing the cumulative integral of velocity experienced by each individual along its trajectory (âˆ« ğŸš„ dt).</li><li>The current default is <code>solve(prob,Tsit5(),reltol=1e-8,abstol=1e-8)</code> but all solver options from the <a href="https://github.com/SciML/OrdinaryDiffEq.jl">OrdinaryDiffEq.jl</a> package are available.</li><li>After this, <code>âˆ«!</code> is also equipped to postprocess results recorded into ğŸ”´ via the ğŸ”§ workflow, and the last step in <code>âˆ«!</code> consists in updating ğŸ“Œ to be ready for continuing in a subsequent call to <code>âˆ«!</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaClimate/IndividualDisplacements.jl/blob/72bc66a84d0c1c3600db57763244e83aac9d432a/src/API.jl#L397-L405">source</a></section><section><div><pre><code class="language-julia hljs">âˆ«!(I::Individuals)</code></pre><p>Call âˆ«!(I::Individuals,I.P.T)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaClimate/IndividualDisplacements.jl/blob/72bc66a84d0c1c3600db57763244e83aac9d432a/src/API.jl#L431-L435">source</a></section></article><p>The velocity interpolation functions (ğŸš„) carry out the central computation of this package â€“ interpolating gridded flow fields to individual positions ğŸ“Œ. It is normally called via <code>âˆ«!</code> to integrate velocity ğŸš„ over a chosen time period. </p><ul><li>Velocity interpolation for several array and grid types.</li><li>Preprocessing and postprocessing methods.</li><li>I/O routines to read (write) results from (to) file.</li></ul><p>and other functionalities provided in <code>src/compute.jl</code> and <code>src/data_wrangling.jl</code> are further documented in the <em>Tool Box</em> section. Ingestion of trajectory data which have been collected by the <a href="https://doi.org/10.1002/2016JC011716">Ocean Drifting Buoy Program</a> (<a href="https://youtu.be/82HPnYBtoVo">movie</a>) is also supported.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">Â« Introduction</a><a class="docs-footer-nextpage" href="../examples/">Examples Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Sunday 10 November 2024 04:29">Sunday 10 November 2024</span>. Using Julia version 1.10.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
